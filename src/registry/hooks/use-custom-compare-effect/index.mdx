---
title: useCustomCompareEffect
description: A hook like useEffect but with a custom compare function
---

import { Demo01 } from './demo/demo-01'

> Only when the user's ID changes will the effect be triggered

<Demo01 />

## Installation

<Tabs items={['CLI', 'Manual']}>
  <Tab>
    <InstallCLI value='use-custom-compare-effect' />
  </Tab>
  <Tab>
    Copy and paste the following code into your project.
    <RegistrySourceCode value='use-custom-compare-effect' />
  </Tab>
</Tabs>

## API

```ts
/**
 * A hook like useEffect but with a custom compare function
 * @param effect - The effect to use
 * @param deps - The dependencies to use
 * @param customCompare - The custom compare function to use
 */
function useCustomCompareEffect<T extends DependencyList>(
  effect: EffectCallback,
  deps: T,
  customCompare: (a: T, b: T) => boolean,
): void
```

## Notes

> **Important:** Do not call `setState` methods inside the `customCompare` function. The compare function should be a pure function that only performs comparison logic.

```ts
// ❌ Don't do this
const compareById = (a: User[], b: User[]) => {
  const result = a[0]?.id === b[0]?.id
  setCount((prev) => prev + 1) // ❌ This will cause infinite re-renders
  return result
}

// ✅ Do this instead
const compareById = (a: User[], b: User[]) => {
  const result = a[0]?.id === b[0]?.id
  return result
}
```

## Credits

- [createDeepCompareEffect](https://github.com/alibaba/hooks/blob/master/packages/hooks/src/createDeepCompareEffect/index.ts)
- [useCustomCompareEffect](https://github.com/streamich/react-use/blob/master/src/useCustomCompareEffect.ts)
